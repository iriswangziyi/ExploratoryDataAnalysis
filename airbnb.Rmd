---
title: "MATH 189 Homework 3"
author: "Weixiu Dong, Mengheng Yang, Xuqian Tan, Yushan Liu, Iris Ziyi Wang"
date: "1/24/2020"
output:
  html_document:
    df_print: paged
---

## Dataset Description
```{r}
data <- read.csv('AB_NYC_2019.csv')
```

This dataset describes the Airbnb listing activity and metrics in NYC, NY for 2019.
There are 48896 observations.
 
*Reference:* <br />
An exploratory data analysis on airbnb listings in NYC in 2019
Raw dataset source: https://www.kaggle.com/dgomonov/new-york-city-airbnb-open-data

```{r}
names(data)
dim(data)
head(data)
```
There are 16 variables (with explanations):<br />
1. Id (listing ID), <br />
2. name (name of the listing), <br />
3. host_id (host ID), <br />
4. host_name (name of the host), <br />
5. neighbourhood_group (location), <br />
6. neighbourhood (area), <br />
7. latitude (latitude coordinates), <br />
8. longitude (longitude coordinates), <br />
9. room_type (listing space type), <br />
10. price (price in dollars), <br />
11. minimum_nights (amount of nights minimum), <br />
12. number_of_reviews (number of reviews), <br />
13. last_review (latest review), <br />
14. reviews_per_month (number of reviews per month), <br />
15. calculated_host_listings_count (amount of listing per host), <br />
16. availability_365 (number of days when listing is available for booking)<br />

## Research Question
### What factors would affect the popularity of different room typesï¼Ÿ

## Data Cleaning
Based on our research question, we will group my data with room types. <br />
There are 3 different categories for room type: **Private room**, **Entire home/apt** and  **Shared room**.  
```{r}
summary(as.factor(data$room_type))
```

Let's keep only relevant columns for our research question.
```{r}
keeps <- c('neighbourhood_group', 'room_type','price','minimum_nights', 'number_of_reviews','availability_365')
df = data[,names(data) %in% keeps]
names(df)
dim(df)
head(df)
```

Cleaning **availability_365**: remove all unreasonable values (all 0 values)
```{r}
df<-df[!(df$availability_365 ==0),]
```

Cleaning **minimum_nights**: remove all values above 100
```{r}
df<-df[!(df$minimum_nights > 100),]
```

## Table 1
```{r}
library("table1")
table1(~ neighbourhood_group +
       price + 
       minimum_nights + 
       number_of_reviews +
       availability_365 | room_type,
       data=df)
```

## Data Visualization / Ploting
### Bar plots for categorical variables

```{r, echo=FALSE}
library(ggplot2)
bar_tbl <- with(df, table(room_type, neighbourhood_group ))

ggplot(as.data.frame(bar_tbl), aes(x= factor(room_type), y = Freq , fill =neighbourhood_group)) +
  geom_bar(stat="identity", position = "dodge") + 
  scale_fill_brewer(palette = "Set1")
```

### Plots for continous variable


and also **availability_365**.
```{r}
ggplot(df, aes(x=room_type, y= availability_365)) + 
    geom_boxplot()
```


Then, we explore some variables that are highly skewed with both boxplots and histgorams by groups.

Let's first take a look at **price** by groups.
```{r}
ggplot(df,aes(x=price))+
    geom_histogram(bins = 100)+
    facet_grid(~room_type)+
    theme_bw()

ggplot(df, aes(x=room_type, y=price)) + 
    geom_boxplot()

```

Then **minimum_nights**. 
```{r}

ggplot(df,aes(x=minimum_nights))+
    geom_histogram(bins = 100)+
    facet_grid(~room_type)+
    theme_bw()

ggplot(df, aes(x=room_type, y= minimum_nights)) + 
    geom_boxplot()

```


We can look into **number_of_review** by just investigating the histogram by groups.
```{r}
ggplot(df,aes(x=number_of_reviews))+
    geom_histogram(bins = 100)+
    facet_grid(~room_type)+
    theme_bw()
```
